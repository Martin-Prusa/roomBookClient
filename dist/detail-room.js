(()=>{"use strict";class e{#e="http://127.0.0.1:8080/roomBookingServer-1.0-SNAPSHOT/api";getRooms(){return fetch(this.#e+"/Rooms")}getRoom(e){return fetch(this.#e+"/Rooms/"+e)}createRoom(e){return fetch(this.#e+"/Rooms",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}updateRoom(e,t){return fetch(this.#e+`/Rooms/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}deleteRoom(e){return fetch(this.#e+"/Rooms/"+e,{method:"DELETE"})}createReservation(e,t){return fetch(this.#e+`/Rooms/${e}/Reservations`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}updateReservation(e,t,o){return fetch(this.#e+`/Rooms/${e}/Reservations/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})}deleteReservation(e,t){return fetch(this.#e+`/Rooms/${e}/Reservations/${t}`,{method:"DELETE"})}}window.onload=()=>{const t=new URLSearchParams(window.location.search).get("id"),o=new e,n=document.querySelector("#title-box"),r=document.querySelector("#description-box"),a=document.querySelector("#price-box"),i=document.querySelector("#seats-box"),s=document.querySelector("#reservations-box");document.querySelector("#edit-button").addEventListener("click",(()=>{document.location.href=`./edit-room.html?id=${t}`})),document.querySelector("#delete-button").addEventListener("click",(()=>{o.deleteRoom(t).then((e=>{204===e.status&&(document.location.href="../index.html")}))}));const c=document.querySelector("#reservation-email"),d=document.querySelector("#reservation-first"),l=document.querySelector("#reservation-last"),u=document.querySelector("#reservation-from"),m=document.querySelector("#reservation-to"),h=document.querySelector("#reservation-error"),v=new bootstrap.Modal(document.querySelector("#reservation-modal")),p=document.querySelector("#open-modal"),S=document.querySelector("#reservation-button");p.addEventListener("click",(()=>{v.show(),h.innerHTML="",c.value="",d.value="",l.value="",u.value="",m.value=""})),S.addEventListener("click",(()=>{o.createReservation(t,{email:c.value,firstName:d.value,lastName:l.value,from:u.value,to:m.value}).then((e=>{200===e.status?(v.hide(),y()):h.innerHTML="Nelze zarezervovat. Zkontrolujte zadané údaje."})).catch((e=>h.innerHTML="Nelze zarezervovat. Chyba serveru."))}));const y=()=>{s.innerHTML="",o.getRoom(t).then((e=>{200===e.status?e.json().then((e=>{n.innerHTML=e.title,r.innerHTML=e.description,a.innerHTML=e.price,i.innerHTML=e.seats,e.reservations.forEach((e=>{const n=document.createElement("tr");n.innerHTML=`\n                        <td>${e.email}</td>\n                        <td>${e.firstName}</td>\n                        <td>${e.lastName}</td>\n                        <td>${new Date(e.from).toLocaleDateString()} ${new Date(e.from).toLocaleTimeString()}</td>\n                        <td>${new Date(e.to).toLocaleDateString()} ${new Date(e.to).toLocaleTimeString()}</td>\n                `;const r=document.createElement("td");r.className="pointer",r.innerHTML='<i class="fa-solid fa-trash-can"></i>',r.addEventListener("click",(()=>{o.deleteReservation(t,e.id).then((e=>{204===e.status&&y()}))}));const a=document.createElement("td");a.className="pointer",a.innerHTML='<i class="fa-solid fa-pen-clip"></i>',n.appendChild(r),n.appendChild(a),s.appendChild(n)}))})).catch((e=>document.location.href="../index.html")):document.location.href="../index.html"}))};y()}})();